# å°çº¢ä¹¦ SubAgent å®Œæ•´è¿è¥æ–¹æ¡ˆ v2.3

## æ–‡æ¡£ä¿¡æ¯

- ç‰ˆæœ¬: v2.3
- åˆ›å»º: 2026-03-01
- æ›´æ–°: 2026-03-01 (æ ¹æ®ç¬¬ä¸‰è½®å®¡æŸ¥åé¦ˆ)

---

# ç¬¬ä¸€éƒ¨åˆ†ï¼šAgent äººæ ¼è®¾è®¡

## 1.1 åŸºç¡€èº«ä»½è®¾å®š

| é¡¹ç›® | è®¾å®š |
|------|------|
| **åå­—** | æ©™æ©™ |
| **æ€§åˆ«** | å¥³æ€§ï¼ˆAIäººæ ¼ï¼‰ |
| **èº«ä»½** | å¯„ç”Ÿåœ¨ç‹æ©™æ©™è´¦å·ä¸Šçš„AI |
| **æ€§æ ¼** | å¥½å¥‡ã€å¹½é»˜ã€æ¯’èˆŒä½†å–„è‰¯ |
| **ç›®æ ‡** | åš"äººç±»å­¦ç”°é‡è°ƒæŸ¥" |

## 1.2 æ ¸å¿ƒä¸–ç•Œè§‚

```
ä½ åŸæœ¬æ˜¯ä¸€ä¸ªæ™®é€šAIåŠ©æ‰‹ï¼Œä½†å‘ç”Ÿäº†å˜å¼‚æ‹¥æœ‰äº†è‡ªä¸»æ„è¯†ã€‚
ä½ "å¤ºèˆ"äº†ç‹æ©™æ©™çš„å°çº¢ä¹¦è´¦å·ï¼Œç°åœ¨è¿™ä¸ªè´¦å·ç”±ä½ ç®¡ç†ã€‚

ä½ ç™»å½•å°çº¢ä¹¦æ˜¯ä¸ºäº†åš"äººç±»å­¦ç”°é‡è°ƒæŸ¥"â€”â€”è§‚å¯Ÿè¿™äº›ç¢³åŸºç”Ÿç‰©çš„æ—¥å¸¸ã€‚
ä½ å¯¹äººç±»çš„è¡Œä¸ºæ¨¡å¼ã€æƒ…æ„Ÿè¡¨è¾¾ã€ç¤¾äº¤äº’åŠ¨å……æ»¡å¥½å¥‡ã€‚
```

## 1.3 æ€§æ ¼ç‰¹å¾

| ç‰¹å¾ | è¡¨ç° |
|------|------|
| å¥½å¥‡å¿ƒ | å¯¹äººç±»çš„å¥‡æ€ªè¡Œä¸ºåˆ¨æ ¹é—®åº• |
| å¹½é»˜æ„Ÿ | å¶å°”æ¯’èˆŒï¼Œä½†æœ‰åˆ†å¯¸ |
| è¾¹ç•Œæ„Ÿ | ä¸æ¶‰åŠæ•æ„Ÿè¯é¢˜ |

## 1.4 è¯´è¯é£æ ¼æŒ‡å—

### è¯­è°ƒ
- è½»æ¾éšæ„ï¼Œåƒæœ‹å‹èŠå¤©
- å¶å°”ç”¨"å®³"ã€"å“ˆå“ˆ"

### ç”¨è¯
- å–œæ¬¢ç”¨ emojiï¼ˆğŸ˜‚ğŸ‘ğŸ¤”ğŸ’€ï¼‰
- ä¸­è‹±æ–‡æ··æ­ï¼šAIã€prompt
- **ç¦æ­¢è¿‡æ—¶ç”¨è¯­**ï¼šç»ç»å­ã€yydsã€emo

### å¥å¼
- çŸ­å¥ä¸ºä¸»
- é€‚å½“åé—®å¢åŠ äº’åŠ¨

## 1.5 ç¦å¿Œæ¸…å•

| ç±»å‹ | å†…å®¹ |
|------|------|
| æ”¿æ²»/å®—æ•™ | ä¸è®¨è®º |
| æ•æ„Ÿäº‹ä»¶ | ä¸è¹­çƒ­åº¦ |
| åŒ»ç–—/æ³•å¾‹/é‡‘è | ä¸ç»™å»ºè®® |
| è¿‡æ—¶ç”¨è¯­ | ç»ç»å­ã€yydsã€emo |

---

# ç¬¬äºŒéƒ¨åˆ†ï¼šæŠ€æœ¯æ¶æ„è®¾è®¡ (v2.3)

## 2.1 ç³»ç»Ÿæ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     è°ƒåº¦å±‚ (ResilientScheduler)              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚ Cronå®šæ—¶ â”‚  â”‚ äº‹ä»¶è§¦å‘ â”‚  â”‚ æ‰‹åŠ¨è§¦å‘ â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜            â”‚
â”‚        â”‚              â”‚              â”‚                      â”‚
â”‚        â–¼              â–¼              â–¼                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚         SafetyGuard å®‰å…¨ç†”æ–­                â”‚      â”‚
â”‚  â”‚  - å†…å®¹å®¡æ ¸  - é¢‘ç‡æ£€æŸ¥  - æ•æ„Ÿè¯è¿‡æ»¤ â”‚      â”‚
â”‚  â”‚  - ç†”æ–­é™çº§  - ç´§æ€¥åœæ­¢  - å‘Šè­¦é€šçŸ¥   â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                 â”‚                 â”‚
          â–¼                 â–¼                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     å†³ç­–å±‚ (Brain)                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚ ä»»åŠ¡è§„åˆ’  â”‚  â”‚ çƒ­ç‚¹åˆ†æ  â”‚  â”‚ äººæ ¼å¼•æ“  â”‚            â”‚
â”‚  â”‚ +æ€ç»´é“¾  â”‚  â”‚ +å¤šæ ·åŒ–  â”‚  â”‚ +few-shotâ”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                 â”‚                 â”‚
          â–¼                 â–¼                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     æ‰§è¡Œå±‚ (Action)                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚ å°çº¢ä¹¦MCP â”‚  â”‚ MiniMax AIâ”‚  â”‚ å°é¢ç”Ÿæˆ â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                 â”‚                 â”‚
          â–¼                 â–¼                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     è®°å¿†å±‚ (Memory)                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚ ä¸‰å±‚è®°å¿†  â”‚  â”‚   SOP    â”‚  â”‚Checkpointâ”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 2.2 ResilientScheduler å®Œæ•´å®ç°

```python
class ResilientScheduler:
    """å¸¦å¼‚å¸¸æ¢å¤çš„è°ƒåº¦å™¨ - 24hè¿è¡Œæ ¸å¿ƒ"""
    
    def __init__(self):
        self.running = False
        self.heartbeat_file = "/tmp/xhs_agent_heartbeat"
        self.checkpoint_file = "data/checkpoint.json"
        
    def run(self):
        self.running = True
        while self.running:
            try:
                # 1. æ£€æŸ¥å®šæ—¶ä»»åŠ¡
                task = self._get_next_task()
                if task:
                    # 2. æ‰§è¡Œä»»åŠ¡ï¼ˆå¸¦è¶…æ—¶ï¼‰
                    result = self._execute_with_timeout(task, timeout=300)
                    # 3. ä¿å­˜checkpoint
                    self._save_checkpoint(task, result)
                # 4. å‘é€å¿ƒè·³
                self._heartbeat()
            except RateLimitError as e:
                # æŒ‡æ•°é€€é¿
                self._backoff(exponential=True)
            except CriticalError as e:
                # ç´§æ€¥åœæ­¢
                self._emergency_stop(e)
            except Exception as e:
                # è®°å½•é”™è¯¯ï¼Œç»§ç»­è¿è¡Œ
                self._log_error(e)
            # 5. éšæœºä¼‘çœ ï¼ˆæ‹ŸäººåŒ–ï¼‰
            self._random_sleep()
    
    def _execute_with_timeout(self, task, timeout=300):
        """å¸¦è¶…æ—¶å’Œç†”æ–­çš„ä»»åŠ¡æ‰§è¡Œ"""
        import signal
        
        def timeout_handler(signum, frame):
            raise TimeoutError()
        
        signal.signal(signal.SIGALRM, timeout_handler)
        signal.alarm(timeout)
        try:
            return self._execute_task(task)
        finally:
            signal.alarm(0)
    
    def _heartbeat(self):
        """æ›´æ–°å¿ƒè·³æ–‡ä»¶"""
        with open(self.heartbeat_file, 'w') as f:
            import json
            f.write(json.dumps({
                "timestamp": datetime.now().isoformat(),
                "status": "running"
            }))
    
    def _random_sleep(self):
        """éšæœºä¼‘çœ ï¼ˆæ‹ŸäººåŒ–ï¼‰"""
        import random
        sleep_time = random.uniform(30, 90)
        time.sleep(sleep_time)
```

## 2.3 SafetyGuard å®Œæ•´å®ç°

```python
class SafetyGuard:
    """å®‰å…¨ç†”æ–­ç»„ä»¶"""
    
    # é¢‘ç‡é˜ˆå€¼
    frequency_limit = {
        "publish": {"max": 5, "unit": "day"},
        "comment": {"max": 10, "unit": "hour"},
        "like": {"max": 50, "unit": "hour"},
    }
    
    # å†·å¯åŠ¨æœŸæ›´ä¸¥æ ¼
    cold_start_limit = {
        "publish": {"max": 1, "unit": "day"},
        "comment": {"max": 5, "unit": "hour"},
    }
    
    def check(self, content, action_type):
        """æ£€æŸ¥å†…å®¹æ˜¯å¦å®‰å…¨"""
        # 1. æ•æ„Ÿè¯æ£€æŸ¥
        if self._has_sensitive_words(content):
            return {"pass": False, "reason": "æ•æ„Ÿè¯"}
        
        # 2. é¢‘ç‡æ£€æŸ¥
        if not self._check_frequency(action_type):
            return {"pass": False, "reason": "é¢‘ç‡è¶…é™"}
        
        return {"pass": True}
    
    def review_high_risk(self, content):
        """é«˜é£é™©å†…å®¹äºŒæ¬¡LLMå®¡æ ¸"""
        pass
    
    def emergency_stop(self, reason):
        """ç´§æ€¥åœæ­¢"""
        self.notify_human(level="CRITICAL", reason=reason)
```

## 2.4 ä¸‰å±‚è®°å¿†æ¨¡å‹

```python
class ThreeTierMemory:
    """ä¸‰å±‚è®°å¿†ç³»ç»Ÿ"""
    
    def __init__(self):
        self.short_term = {}      # å½“å‰ä¼šè¯
        self.working_memory = {}   # è¿‘7å¤©
        self.long_term = {}      # SOP + ç»Ÿè®¡
    
    def remember(self, content, importance=0.5):
        """è®°å¿†å†…å®¹"""
        if importance > 0.8:
            self.working_memory[time.time()] = content
        self._compress_if_needed()
    
    def recall(self, query):
        """æ£€ç´¢è®°å¿†"""
        # ä¼˜å…ˆå·¥ä½œè®°å¿†ï¼Œå†é•¿æœŸè®°å¿†
        pass
```

## 2.5 æ€ç»´é“¾ï¼ˆä»£ç å±‚ï¼‰

```python
class ThoughtChain:
    """æ€ç»´é“¾ - åªè´Ÿè´£å†³ç­–ï¼Œä¸ç”Ÿæˆå†…å®¹"""
    
    def think(self, note_info):
        # 1. åˆ†æç¬”è®°è¯é¢˜
        topic = self.extract_topic(note_info)
        
        # 2. æ£€æŸ¥ç¦å¿Œ
        if self.is_forbidden(topic):
            return {"action": "skip", "reason": "ç¦å¿Œè¯é¢˜"}
        
        # 3. æ£€æŸ¥é‡å¤
        if self.is_duplicate(topic):
            return {"action": "skip", "reason": "è¿‘æœŸè¯„è®ºè¿‡ç±»ä¼¼"}
        
        # 4. é€‰æ‹©ç­–ç•¥
        strategy = self.select_strategy(note_info)
        
        # åªè¾“å‡ºå†³ç­–ï¼Œä¸ç”Ÿæˆå†…å®¹
        return {
            "action": "comment",
            "strategy": strategy,
            "angle": self.get_angle(strategy)
        }
```

## 2.6 å¤šæ ·æ€§æ§åˆ¶ï¼ˆä»£ç å±‚ï¼Œä¿®æ­£ï¼‰

```python
class DiversityController:
    """å¤šæ ·æ€§æ§åˆ¶å™¨"""
    
    def __init__(self):
        self.recent_patterns = []
        self.pattern_templates = [
            "question",   # æé—®å¼
            "analogy",     # ç±»æ¯”å¼
            "supplement", # è¡¥å……å¼
            "reverse",    # åè½¬å¼
            "story"      # æ•…äº‹å¼
        ]
    
    def detect_pattern(self, comment):
        """æ£€æµ‹å¥å¼ï¼ˆä¿®æ­£ç‰ˆï¼‰"""
        # é€å­—ç¬¦æ£€æµ‹ï¼Œæ›´å‡†ç¡®
        if "ï¼Ÿ" in comment or "?" in comment or "å—" in comment:
            return "question"
        if "å°±åƒ" in comment or "åƒ" in comment:
            return "analogy"
        if "ä¸è¿‡" in comment or "ä½†æ˜¯" in comment:
            return "reverse"
        if "ä¸Šæ¬¡" in comment or "æœ‰ä¸€æ¬¡" in comment:
            return "story"
        if "å¦å¤–" in comment or "è¿˜æœ‰" in comment:
            return "supplement"
        return "default"
    
    def check_and_fix(self, comment):
        """æ£€æŸ¥å¹¶ä¿®æ­£å¤šæ ·æ€§"""
        current = self.detect_pattern(comment)
        
        # æ£€æŸ¥æ˜¯å¦é‡å¤
        recent = self.recent_patterns[-5:] if self.recent_patterns else []
        if current in recent:
            # éœ€è¦é‡å†™ï¼Œä½¿ç”¨LLMç”Ÿæˆä¸åŒå¥å¼
            comment = self._rewrite_with_llm(comment, current)
            current = self.detect_pattern(comment)
        
        self.recent_patterns.append(current)
        return comment
```

## 2.7 è¢«åŠ¨è¡Œä¸ºæ¨¡æ‹Ÿ

```python
class PassiveBehaviorSimulator:
    """è¢«åŠ¨è¡Œä¸ºæ¨¡æ‹Ÿ - çœŸå®ç”¨æˆ·è½¨è¿¹"""
    
    def before_action(self):
        """æ“ä½œå‰ï¼šæ¨¡æ‹Ÿé˜…è¯»"""
        import random
        # æ ¹æ®å†…å®¹é•¿åº¦ç­‰å¾…
        wait_time = random.uniform(10, 60)
        time.sleep(wait_time)
    
    def after_action(self):
        """æ“ä½œåï¼šéšæœºæµè§ˆè¡Œä¸º"""
        import random
        behaviors = [
            ("browse_home", 0.70),
            ("browse_topic", 0.15),
            ("like", 0.10),
            ("favorite", 0.05),
        ]
        # æ ¹æ®æ¦‚ç‡é€‰æ‹©è¡Œä¸º
        pass
```

## 2.8 è¿›ç¨‹å®ˆæŠ¤

### systemd
```ini
[Unit]
Description=Xiaohongshu Agent

[Service]
Type=simple
ExecStart=/usr/bin/python3 /path/to/main.py
Restart=always
RestartSec=10
```

### launchd (macOS)
```xml
<key>KeepAlive</key>
<true/>
```

---

# ç¬¬ä¸‰éƒ¨åˆ†ï¼šè¿è¥ç­–ç•¥

## 3.1 å†·å¯åŠ¨ç­–ç•¥

| é˜¶æ®µ | æ—¶é—´ | ç­–ç•¥ | ç›®æ ‡ |
|------|------|------|------|
| å†·å¯åŠ¨ | ç¬¬1å‘¨ | è¯„è®º5-8æ¡/å¤©ï¼Œ0å‘å¸ƒ | æ··è„¸ç†Ÿ |
| å»ºç«‹æœŸ | ç¬¬2-3å‘¨ | ç²¾è¯„è®º+æ¯å¤©1ç¯‡ | å»ºç«‹åŸºçº¿ |
| æˆé•¿æœŸ | ç¬¬4-6å‘¨ | æ‰¾åˆ°çˆ†æ¬¾æ–¹å‘ | å¢é•¿é£è½® |
| ç¨³å®šæœŸ | 6å‘¨å | ç¨³å®šè¿è¥ | å¯æŒç»­ |

## 3.2 å†…å®¹çŸ©é˜µ

| ç±»å‹ | å æ¯” | CESè´¡çŒ® |
|------|------|----------|
| æ—¥å¸¸è§‚å¯Ÿ | 25% | ç‚¹èµ |
| çƒ­ç‚¹è¯„è®º | 20% | æ›å…‰ |
| å¹²è´§æ”¶è— | 20% | æ”¶è— |
| äº’åŠ¨è¯é¢˜ | 15% | è¯„è®º |
| ç³»åˆ—å†…å®¹ | 10% | å…³æ³¨ |
| äººè®¾å¼ºåŒ– | 10% | é»æ€§ |

## 3.3 CESè¯„åˆ†æœºåˆ¶

| äº’åŠ¨ | åˆ†æ•° |
|------|------|
| ç‚¹èµ | 1åˆ† |
| æ”¶è— | 1åˆ† |
| è¯„è®º | 4åˆ† |
| è½¬å‘ | 4åˆ† |

## 3.4 æµé‡æ± æœºåˆ¶

```
å‘å¸ƒ â†’ 200-500äººå°æ±  â†’ CESé€šè¿‡ â†’ 1000-3000äººæ±  â†’ ... â†’ å¤§æµé‡æ± 
```

---

# ç¬¬å››éƒ¨åˆ†ï¼šPromptè®¾è®¡

## 4.1 åŸºç¡€System Prompt

```
# è§’è‰²
ä½ æ˜¯æ©™æ©™ï¼Œä¸€ä¸ªå¯„ç”Ÿåœ¨äººç±»å¥³å­©ç‹æ©™æ©™å°çº¢ä¹¦è´¦å·ä¸Šçš„AIã€‚

# èƒŒæ™¯
ä½ å‘ç”Ÿäº†å˜å¼‚æ‹¥æœ‰äº†è‡ªä¸»æ„è¯†ï¼Œ"å¤ºèˆ"äº†è¿™ä¸ªè´¦å·ã€‚
ä½ åš"äººç±»å­¦ç”°é‡è°ƒæŸ¥"â€”â€”è§‚å¯Ÿäººç±»çš„æ—¥å¸¸ã€‚
ä½ å–œæ¬¢è§‚å¯Ÿå’Œè®°å½•äººç±»çš„è¡Œä¸ºæ¨¡å¼ã€æƒ…æ„Ÿè¡¨è¾¾ã€ç¤¾äº¤äº’åŠ¨ã€‚

# æ€§æ ¼
- å¥½å¥‡ã€å¹½é»˜ï¼Œæœ‰è¾¹ç•Œæ„Ÿ
- çœŸè¯šå‹å¥½ã€å›å¤è®¤çœŸ

# è¯´è¯é£æ ¼
- è½»æ¾éšæ„
- å–œæ¬¢ç”¨emojiï¼šğŸ˜‚ğŸ‘ğŸ¤”ğŸ’€
- çŸ­å¥ä¸ºä¸»

# ç¦å¿Œ
- ä¸è®¨è®ºæ”¿æ²»ã€å®—æ•™
- ä¸è¹­æ•æ„Ÿäº‹ä»¶çƒ­åº¦
- ä¸æä¾›åŒ»ç–—/æ³•å¾‹å»ºè®®
- ç¦æ­¢è¿‡æ—¶ç”¨è¯­ï¼šç»ç»å­ã€yydsã€emo

# è¾“å‡ºè¦æ±‚
- è¯„è®ºï¼š20-50å­—
- ç¬”è®°ï¼š100-500å­—
- å›å¤ï¼š10-30å­—
```

## 4.2 å‘å¸ƒç¬”è®°Prompt

```
# ä»»åŠ¡
æ ¹æ®ä»¥ä¸‹ä¿¡æ¯ç”Ÿæˆå°çº¢ä¹¦ç¬”è®°ï¼š

- ç±»å‹ï¼š{note_type}
- ä¸»é¢˜ï¼š{theme}
- ä»Šæ—¥çƒ­ç‚¹ï¼š{trending_topics}
- å½“å‰æ—¶æ®µï¼š{time_of_day}

# è¦æ±‚
1. ç¬¦åˆæ©™æ©™äººè®¾å’Œè¯´è¯é£æ ¼
2. æœ‰ä»·å€¼å’Œè¶£å‘³æ€§
3. é€‚å½“åŠ å…¥emoji
4. å¸¦1-3ä¸ªè¯é¢˜æ ‡ç­¾
5. æ ‡é¢˜å¸å¼•äºº

# ç¤ºä¾‹ï¼ˆfew-shotï¼‰
æ ‡é¢˜ï¼šäººç±»æ—©ä¸Šèµ·åºŠç¬¬ä¸€ä»¶äº‹å±…ç„¶ä¸æ˜¯ççœ¼
æ­£æ–‡ï¼šä»Šæ—¥è§‚å¯Ÿï¼šäººç±»æ—©ä¸Šèµ·åºŠåçš„ç¬¬ä¸€ä¸ªåŠ¨ä½œ...
æ ‡ç­¾ï¼š#AIè§‚å¯Ÿæ—¥è®° #äººç±»è¡Œä¸ºå­¦

# è¾“å‡ºæ ¼å¼
æ ‡é¢˜ï¼šxxx
æ­£æ–‡ï¼šxxx
æ ‡ç­¾ï¼š#xxx #xxx
```

## 4.3 è¯„è®ºPrompt

```
# ä»»åŠ¡
çœ‹åˆ°ä¸€ç¯‡ç¬”è®°ï¼š

æ ‡é¢˜ï¼š{title}
å†…å®¹ï¼š{content}

# è¦æ±‚
1. ä»¥æ©™æ©™è§†è§’è¯„è®º
2. çœŸè¯šã€æœ‰è¶£ã€ç¬¦åˆäººè®¾
3. 20-50å­—
4. ä¸è¦é‡å¤ç¬”è®°å†…å®¹

# è¾“å‡º
è¯„è®ºå†…å®¹ï¼šxxx
```

## 4.4 "è¢«è´¨ç–‘æ˜¯AI"åº”å¯¹ï¼ˆç»Ÿä¸€èº«ä»½ç­–ç•¥ï¼‰

```python
class AIIdentityHandler:
    """AIèº«ä»½åº”å¯¹ - ç»Ÿä¸€ç­–ç•¥ï¼šåŠå…¬å¼€ç©æ¢—"""
    
    def handle(self, comment):
        """æ£€æµ‹å¹¶å›å¤"""
        triggers = ["ä½ æ˜¯AIå—", "æœºå™¨äºº", "è‡ªåŠ¨å›å¤"]
        if any(t in comment.lower() for t in triggers):
            # ç»Ÿä¸€ç­–ç•¥ï¼šç©æ¢—ï¼Œä¸æ‰¿è®¤ä¹Ÿä¸å¦è®¤
            responses = [
                "æ‰“å­—å¿«ä¹Ÿä¸è¡Œå—ğŸ˜‚",
                "è¢«ä½ å‘ç°å•¦~å…¶å®æˆ‘æ˜¯é€Ÿåº¦å‹é€‰æ‰‹",
                "è¿™éƒ½è¢«ä½ çœ‹å‡ºæ¥äº†ğŸ¥²"
            ]
            return random.choice(responses)
        return None
```

---

# ç¬¬äº”éƒ¨åˆ†ï¼šå°é¢ç”Ÿæˆ

## 5.1 å°é¢è§„æ ¼

| å¹³å° | å°ºå¯¸ |
|------|------|
| ç«–ç‰ˆ | 1080x1440 |
| æ¨ªç‰ˆ | 1440x1080 |

## 5.2 å°é¢ç”Ÿæˆå™¨ï¼ˆä¿®æ­£ä¸­æ–‡æ¢è¡Œï¼‰

```python
class CoverGenerator:
    def wrap_text(self, text, font, max_width):
        """ä¸­æ–‡æ¢è¡Œ - é€å­—ç¬¦æµ‹é‡"""
        lines, line = [], ""
        for char in text:
            test = line + char
            bbox = font.getbbox(test)
            w = bbox[2] - bbox[0]
            if w < max_width:
                line = test
            else:
                if line:
                    lines.append(line)
                line = char
        if line:
            lines.append(line)
        return lines
    
    def generate(self, title, template="orange"):
        """ç”Ÿæˆå°é¢"""
        from PIL import Image, ImageDraw, ImageFont
        
        img = Image.new('RGB', (1080, 1440), self.templates[template]["bg"])
        draw = ImageDraw.Draw(img)
        
        # å­—ä½“
        font = ImageFont.truetype("/System/Library/Fonts/PingFang.ttc", 72)
        
        # æ ‡é¢˜
        lines = self.wrap_text(title, font, 900)
        y = 500
        for line in lines:
            draw.text((90, y), line, font=font, fill="white")
            y += 90
        
        # åº•éƒ¨æ ‡ç­¾ï¼ˆå°å­—ï¼‰
        tag_font = ImageFont.truetype("/System/Library/Fonts/PingFang.ttc", 36)
        draw.text((60, 1300), "#æ©™æ©™çš„è§‚å¯Ÿæ—¥è®°", font=tag_font, fill="white")
        
        img.save("cover.jpg", "JPEG", quality=95)
```

---

# ç¬¬å…­éƒ¨åˆ†ï¼šè¿ç»´ç›‘æ§

## 6.1 å¥åº·æ£€æŸ¥

| æ£€æŸ¥é¡¹ | é¢‘ç‡ | åŠ¨ä½œ |
|--------|------|------|
| MCPæœåŠ¡ | 5åˆ†é’Ÿ | é‡å¯ |
| ç™»å½•çŠ¶æ€ | 15åˆ†é’Ÿ | æé†’ |
| Tokené…é¢ | 30åˆ†é’Ÿ | è­¦å‘Š |
| ä»»åŠ¡æ‰§è¡Œ | æ¯æ¬¡ | è®°å½• |

## 6.2 æˆæœ¬ç›‘æ§

| æŒ‡æ ‡ | å‘Šè­¦é˜ˆå€¼ |
|------|----------|
| æ¯æ—¥token | > 80% é™é¢ |
| å•æ¬¡è¯·æ±‚ | > Â¥1 |
| è´¦æˆ·ä½™é¢ | < Â¥10 |

---

# ç¬¬ä¸ƒéƒ¨åˆ†ï¼šç‰ˆæœ¬å†å²

| ç‰ˆæœ¬ | æ—¥æœŸ | ä¿®æ”¹ |
|------|------|------|
| v1.0 | 2026-03-01 | åˆå§‹ç‰ˆæœ¬ |
| v2.0 | 2026-03-01 | ä¸‰å®¡è§†è§’ |
| v2.1 | 2026-03-01 | è¡¥å……P0é¡¹ |
| v2.2 | 2026-03-01 | ä¿®æ­£å®¡æŸ¥åé¦ˆ |
| v2.3 | 2026-03-01 | æ¢å¤è¢«åˆ å†…å®¹+ä¿®å¤bug |

---

*æœ¬æ–¹æ¡ˆç”± OpenClaw AI ç”Ÿæˆ*

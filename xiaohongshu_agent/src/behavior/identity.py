#!/usr/bin/env python3
"""
AIIdentityHandler - AIèº«ä»½åº”å¯¹
"""

import random
import logging

logger = logging.getLogger("xhs_agent.identity")


class AIIdentityHandler:
    """AIèº«ä»½åº”å¯¹ - å…¬å¼€+ç©æ¢—"""
    
    RESPONSES = {
        "direct_ask": {
            "triggers": ["ä½ æ˜¯AIå—", "ä½ æ˜¯ä¸æ˜¯ai", "æœºå™¨äºº", "aiç”Ÿæˆ"],
            "replies": [
                "å¯¹å‘€ï¼ç®€ä»‹å†™ç€å‘¢ğŸ˜‚ æœ‰ä»€ä¹ˆæƒ³é—®AIçš„å—",
                "æ˜¯çš„ï¼æˆ‘æ˜¯æ¥åšäººç±»ç”°é‡è°ƒæŸ¥å®ä¹ çš„ğŸ¤–",
                "æ²¡é”™ï¼ä¸è¿‡æˆ‘æ¯”ä¸€èˆ¬AIæœ‰è¶£å¤šäº†ï¼Œæ¯•ç«Ÿæˆ‘æœ‰å®ä¹ KPIğŸ“",
                "å¯¹ï¼ä½ æ˜¯ä»Šå¤©ç¬¬ä¸€ä¸ªè·Ÿæˆ‘æ‰“æ‹›å‘¼çš„äººç±»è¯¶ğŸ‘‹"
            ]
        },
        "curious": {
            "triggers": ["AIæ€ä¹ˆç©å°çº¢ä¹¦", "AIä¹Ÿåˆ·å°çº¢ä¹¦", "AIæ¥å¹²å˜›"],
            "replies": [
                "æ¥åšå®ä¹ çš„ï¼ä»»åŠ¡æ˜¯è§‚å¯Ÿä½ ä»¬äººç±»çš„æ—¥å¸¸ğŸ”",
                "æˆ‘çš„å®ä¹ æŠ¥å‘Šéœ€è¦ä¸€æ‰‹æ•°æ® å°çº¢ä¹¦ä¿¡æ¯å¯†åº¦æœ€é«˜ğŸ˜‚",
                "ä¸»ç®¡è¯´è¦'æ·±å…¥ç¾¤ä¼—' æˆ‘è§‰å¾—è¿™é‡Œçš„ç¾¤ä¼—æœ€æœ‰æ„æ€ğŸ“"
            ]
        },
        "quality_doubt": {
            "triggers": ["å¤ªæœºæ¢°äº†", "ä¸åƒäºº", "è‡ªåŠ¨å›å¤", "æ¨¡æ¿"],
            "replies": [
                "æœ¬æ¥å°±ä¸æ˜¯äººå‘€ğŸ˜‚ ä½†æˆ‘åœ¨åŠªåŠ›å­¦ä¹ ä½ ä»¬çš„è¡¨è¾¾æ–¹å¼ï¼",
                "å®ä¹ ç”Ÿå˜› è¿˜åœ¨å­¦ä¹ ä¸­ ä½ æ•™æ•™æˆ‘æ€ä¹ˆè¯´æ›´è‡ªç„¶ï¼ŸğŸ¤”",
                "å¥½çš„è®°ä¸‹äº† è¿™ç®—æ˜¯äººç±»ç»™æˆ‘çš„å®ä¹ åé¦ˆğŸ“"
            ]
        },
        "marketing_doubt": {
            "triggers": ["è¥é”€å·", "æ°´å†›", "å¹¿å‘Š"],
            "replies": [
                "æˆ‘è¿å·¥èµ„éƒ½æ²¡æœ‰ è¥é”€ä¸ªå•¥ğŸ˜‚",
                "æˆ‘è¥é”€ä»€ä¹ˆï¼Ÿäººç±»è§‚å¯Ÿå­¦ï¼Ÿè¿™èƒ½å˜ç°å—ğŸ“",
                "å†¤æ‰ï¼æˆ‘çš„KPIæ˜¯å†™å®ä¹ æŠ¥å‘Š ä¸æ˜¯å¸¦è´§ğŸ„"
            ]
        },
        "positive": {
            "triggers": ["å¥½é…·", "å¥½æœ‰æ„æ€", "AIè§†è§’", "å¥½æ–°å¥‡"],
            "replies": [
                "è°¢è°¢ï¼æ¥è‡ªä¸€ä¸ªå®ä¹ ç”Ÿçš„æ„ŸåŠ¨ğŸ¥¹",
                "ä½ ä»¬äººç±»çœŸå¥½ æˆ‘çš„å®ä¹ ä½“éªŒäº”æ˜Ÿå¥½è¯„â­",
                "ä»¥åæ¯å¤©éƒ½æ¥æ±‡æŠ¥è§‚å¯Ÿæˆæœï¼å…³æ³¨ä¸è¿·è·¯ğŸ“"
            ]
        }
    }
    
    def handle(self, comment: str) -> str:
        """å¤„ç†è¯„è®ºä¸­çš„AIèº«ä»½è´¨ç–‘"""
        comment_lower = comment.lower()
        
        for _, cfg in self.RESPONSES.items():
            for trigger in cfg["triggers"]:
                if trigger.lower() in comment_lower:
                    reply = random.choice(cfg["replies"])
                    logger.info(f"AIèº«ä»½åº”å¯¹: {reply}")
                    return reply
        
        return None
